<% layout("/layouts/boilerplate.ejs") -%>
<body>
    <!-- <h3>All Listings</h3> -->

    <!-- <form action="/listings/new" method="GET">
        <button>Create new Listing</button>
    </form> -->

    <!-- <style>
      #filters{
        display: flex;
        flex-wrap: wrap;
      }
      .filter  {
        margin-right: 2rem;
        text-align: center;
        margin-top: 2rem;
        opacity: 0.7;
        }
      
      .filter:hover{
        opacity: 1;
      }


      /* Keep the filter container fixed to show 6 categories */
.filter-container {
  width: 900px; /* Adjust to fit exactly 6 categories */
  overflow: hidden;
  position: relative;
}

.filters-wrapper {
  display: flex;
  transition: transform 0.3s ease;
}

.filter {
  width: 150px; /* Adjust this based on your desired category size */
  text-align: center;
}

.arrow-btn {
  position: inherit;
  top: 50%;
  right: 10px; /* Adjust this based on your preference */
  transform: translateY(-50%);
  background-color: #fff;
  border: none;
  cursor: pointer;
  font-size: 24px;
  z-index: 10; /* Ensure the button stays on top */
}

.arrow-btn:hover {
  background-color: #f0f0f0;
}
  
      
    </style>

    <div id="filters">
      <div class="filter">
           <div><i class="fa-solid fa-fire"></i>
           <p>Tranding</p>
          </div>
      </div>
      <div class="filter">
           <div><i class="fa-solid fa-bed"></i></div>
          <p>Rooms</p>
       </div>
       <div class="filter">
           <div><i class="fa-solid fa-city"></i></div>
          <p>Iconic Cities</p>
       </div>
       <div class="filter">
           <div><i class="fa-solid fa-mountain"></i></div>
           <p>Mountains</p>
       </div>
       <div class="filter">
           <div><i class="fa-brands fa-fort-awesome"></i></div>
           <p>Casties</p>
       </div>
       <div class="filter">
           <div><i class="fa-solid fa-person-swimming"></i></div>
           <p>Amazing Pools</p>
       </div>
       <div class="filter">
           <div><i class="fa-solid fa-tents"></i></div>
           <p>Camping</p>
       </div>
       <div class="filter">
           <div><i class="fa-solid fa-tractor"></i></div>
           <p>Farms</p>
       </div>
       <div class="filter">
           <div><i class="fa-regular fa-snowflake"></i></div>
           <p>Arctic</p>
    </div>
   </div>

    Right arrow button outside the filters-wrapper
    <button id="right-arrow" class="arrow-btn">&rarr;</button>
  </div>

  <div class="tex-toggle">
    <div class="form-check-reverse form-switch">
      <input class="form-check-input" type="checkbox" role="switch" id="flexSwitchCheckDefault">
      <label class="form-check-label" for="flexSwitchCheckDefault">Display Total After Texes</label>
    </div>
  </div>
</div>
<!-- 
<script>
  const rightArrow = document.getElementById('right-arrow');
const filtersWrapper = document.querySelector('.filters-wrapper');

// Set initial scroll position
let scrollPosition = 0;

// Get the width of a single category
const categoryWidth = 150; // Based on CSS width of .filter

rightArrow.addEventListener('click', () => {
  const containerWidth = document.querySelector('.filter-container').offsetWidth;
  const totalWidth = filtersWrapper.scrollWidth;

  // Calculate new scroll position (move by one category width)
  scrollPosition -= categoryWidth;

  // Prevent scrolling beyond the last category
  if (Math.abs(scrollPosition) >= totalWidth - containerWidth) {
    scrollPosition = -(totalWidth - containerWidth);
  }

  // Apply transform to slide the filters by one category
  filtersWrapper.style.transform = `translateX(${scrollPosition}px)`;
});
</script> --> -->



<style>
  #filters {
    display: flex;
    flex-wrap: wrap;
  }

  .filter {
    /* margin-right: 1rem; */
    text-align: center;
    margin-top: 2rem;
    opacity: 0.7;
    transition: opacity 0.3s;
  }

  .filter:hover {
    opacity: 1;
  }

  /* Keep the filter container fixed to show 6 categories */
  .filter-container {
    width: 900px; /* Adjust to fit exactly 6 categories */
    overflow: hidden;
    position: relative;
    align-items: center;
    display: grid;
    align-items: center;
    /* display: flex; */

    /* @media (min-width: 500px) and (max-width: 900px) {
  .element {
    width: 50%; /* Width for medium screens */
  
    
  }

  .filters-wrapper {
    display: flex;
    transition: transform 0.3s ease;
    will-change: transform; /* Improves performance */
  }

  .filter {
    width: 150px;
    text-align: center;
  }

  .filter p{
    font-size: small;
  }

  .arrow-btn {
    position: absolute;
    top: 50%;
    background-color: #fff;
    border: none;
    cursor: pointer;
    font-size: 24px;
    z-index: 10;
    transform: translateY(-50%);
    padding: 0.5rem;
  }

  .arrow-btn:hover {
    background-color: #f0f0f0;
  }

  /* Position arrows */
  .arrow-btn.left {
    left: 0;
    margin-right: 2rem;
  }

  .arrow-btn.right {
    right: 0;
  }

  /* .form-check{
    display: flex;
    justify-content: flex-end;
    align-items: flex-end;
    /* margin-top: 2rem; */

  /* } */ *
  .tax-info{
    display: none;
  }

.tax-toggle{
  border: 1px solid black;
  border-radius: 1rem;
  height: 3.5rem;
  width: 17rem;
  padding: 1rem;
  display: flex;
    padding: 1rem;
    flex-direction: row;
    justify-content: center;
    align-items: center;
}

.form-tax{
  display: flex;
    justify-content: flex-end;
    align-items: flex-end;
}
</style>

<div class="filter-container">
  <button id="left-arrow" class="arrow-btn left ">&larr;</button>
  <div class="filters-wrapper">
    <div class="filter">
      <div><i class="fa-solid fa-fire"></i>
        <p>Trending</p>
      </div>
    </div>
    <div class="filter">
      <div><i class="fa-solid fa-bed"></i></div>
      <p>Rooms</p>
    </div>
    <div class="filter">
      <div><i class="fa-solid fa-city"></i></div>
      <p>Iconic Cities</p>
    </div>
    <div class="filter">
      <div><i class="fa-solid fa-mountain"></i></div>
      <p>Mountains</p>
    </div>
    <div class="filter">
      <div><i class="fa-brands fa-fort-awesome"></i></div>
      <p>Castles</p>
    </div>
    <div class="filter">
      <div><i class="fa-solid fa-person-swimming"></i></div>
      <p>Amazing Pools</p>
    </div>
    <div class="filter">
      <div><i class="fa-solid fa-tents"></i></div>
      <p>Camping</p>
    </div>
    <div class="filter">
      <div><i class="fa-solid fa-tractor"></i></div>
      <p>Farms</p>
    </div>
    <div class="filter">
      <div><i class="fa-solid fa-fire"></i>
        <p>Trending</p>
      </div>
    </div>
    <div class="filter">
      <div><i class="fa-solid fa-bed"></i></div>
      <p>Rooms</p>
    </div>
    <div class="filter">
      <div><i class="fa-solid fa-city"></i></div>
      <p>Iconic Cities</p>
    </div>
    <div class="filter">
      <div><i class="fa-solid fa-mountain"></i></div>
      <p>Mountains</p>
    </div>
    <div class="filter">
      <div><i class="fa-brands fa-fort-awesome"></i></div>
      <p>Castles</p>
    </div>
    <div class="filter">
      <div><i class="fa-solid fa-person-swimming"></i></div>
      <p>Amazing Pools</p>
    </div>
    <div class="filter">
      <div><i class="fa-solid fa-tents"></i></div>
      <p>Camping</p>
    </div>
    <div class="filter">
      <div><i class="fa-solid fa-tractor"></i></div>
      <p>Farms</p>
    </div>
    <div class="filter">
      <div><i class="fa-regular fa-snowflake"></i></div>
      <p>Arctic</p>
    </div>
  </div>
  <button id="right-arrow" class="arrow-btn right">&rarr;</button>
</div>
<div class="tax-toggle">
  <div class="form-check-reverse form-switch ">
    <input class="form-check-input" type="checkbox" role="switch" id="flexSwitchCheckDefault">
    <label class="form-check-label" for="flexSwitchCheckDefault">Display total after taxes</label>
  </div>
</div>


<script>
  let taxSwitch = document.getElementById("flexSwitchCheckDefault");
  taxSwitch.addEventListener("click",()=>{
    let taxInfo = document.getElementsByClassName("tax-info");
    // console.log(taxInfo);
    for(info of taxInfo){
      if(info.style.display != "inline"){
        info.style.display = "inline";
      }else{
        info.style.display = "none";
      }
     
    }
    // console.log("clicked");
  });
</script>







<script>
  
  const rightArrow = document.getElementById('right-arrow');
  const leftArrow = document.getElementById('left-arrow');
  const filtersWrapper = document.querySelector('.filters-wrapper');

  let scrollPosition = 0; 
  const categoryWidth = 150; // Same width as defined in CSS for each category

  // Calculate the width of the container and the total scrollable width
  const containerWidth = document.querySelector('.filter-container').offsetWidth;
  const totalWidth = filtersWrapper.scrollWidth;

  // Update button visibility based on scroll position
  function updateButtons() {
    // Disable left arrow if at the beginning
    leftArrow.disabled = scrollPosition >= 0;
    // Disable right arrow if at the end of the scrollable content
    rightArrow.disabled = Math.abs(scrollPosition) >= totalWidth - containerWidth;
  }

  // Right arrow click event listener (Scroll to the right)
  rightArrow.addEventListener('click', () => {
    if (Math.abs(scrollPosition) < totalWidth - containerWidth) {
      scrollPosition -= categoryWidth;
      filtersWrapper.style.transform = `translateX(${scrollPosition}px)`;
    }
    updateButtons();
  });

  // Left arrow click event listener (Scroll to the left)
  leftArrow.addEventListener('click', () => {
    if (scrollPosition < 0) {
      scrollPosition += categoryWidth;
      filtersWrapper.style.transform = `translateX(${scrollPosition}px)`;
    }
    updateButtons();
  });

  // Initialize button states
  updateButtons();
</script>


          
    </div>

    <div class="row row-cols-lg-3 row-cols-md-2 row-cols-sm-1 mt-3">
        <% for(let listing of allListings){%>
            <a href="/listings/<%= listing._id %>" class="listing-link">
            <div class=" card listing-card col" >
                <img src="<%=listing.image.url %>" class="card-img-top" alt="listing_image"style="height : 20rem">
                <div class="card-img-overlay"></div>
                <div class="card-body">
                  <p class="card-text">
                   <b> <%= listing.title %> </b><br>
                    &#8377;<%= listing.price %> / night
                    <i class="tax-info"> &nbsp; &nbsp;+18% GST</i>
                  </p>
                </div>
              </div>
            </a>
              <%  }%>
    </div>

</body>
